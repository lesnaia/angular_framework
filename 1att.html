<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <title>1 Аттестация</title>
</head>

<body>
    <!-- 3 ВАРИАНТ
    Создать модальное окно для аутентификации  (User, pass)
    Проверку пароля выполнить с помощью сервиса
    Выдавать Ошибка в имени и отдельно Ошибка пароля 
    Посчитать количество попыток и отключить кнопку проверки с сообщением Попытка взлома -->
    
           <div class="row" ng-app="myApp" ng-controller="myCtrl">

                <a class="btn btn-primary" href="#" data-toggle="modal" data-target=".login-register-form">
                    Авторизация
                </a>

                <div class="modal fade login-register-form" role="dialog">
                    <div class="modal-dialog modal-sm">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">
                                    <span class="glyphicon glyphicon-remove"></span>
                                </button>
                                <ul class="nav nav-tabs">
                                    <li class="active"><a data-toggle="tab" href="#login-form"> Войти <span
                                                class="glyphicon glyphicon-user"></span></a></li>
                                </ul>
                            </div>
                            <div class="modal-body">
                                <div class="tab-content">
                                    <div id="login-form" class="tab-pane fade in active">
                                        <form name="myForm" action="/" autocomplete="off">
                                            <div class="form-group">
                                                <label for="text">Логин:</label>
                                                <input type="email"  ng-model ="email" class="form-control" id="email"
                                                    placeholder="Введите ваше имя" name="email" required name-validation>
                                                <p class="er" ng-show="myForm.email.$touched && myForm.email.$invalid">Введите другое имя!</p>
                                                <!-- <p class="er">{{emailErrorMessage}}</p> -->
                                            <div class="form-group">
                                                <label for="pwd">Пароль:</label>
                                                <input type="password" class="form-control" id="pwd"
                                                    placeholder="Введите пароль" name="pwd" required password-validation>
                                                    <p class="er" ng-show="myForm.pwd.$touched && myForm.pwd.$invalid">Введите пароль сложнее</p>
                                                    <!-- <p class="er">{{passErrorMessage}}</p> -->
                                            </div>
                                            <button type="submit" class="btn btn-default" ng-disabled="disableInputs">Войти</button>
                                        </form>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

        <script>
            var app = angular.module('myApp', []);
            // Выдавать Ошибка в имени и пароле
            app.directive('nameValidation', function () {
                    return {
                        require: 'ngModel',
                        link: function (scope, element, attr, mCtrl) {
                            function myValidation(value) {
                                if (value == 'Дурак') {
                                    mCtrl.$setValidity('badName', false);
                                } else {
                                    mCtrl.$setValidity('badName', true);
                                }
                                return value;
                            }
                            mCtrl.$parsers.push(myValidation);
                        }
                    };
                });

                app.directive('passwordValidation', function () {
                    return {
                        require: 'ngModel',
                        link: function (scope, element, attr, mCtrl) {
                            function myValidation(value) {
                                if (value == '123') {
                                    mCtrl.$setValidity('badPass', false);
                                } else {
                                    mCtrl.$setValidity('badPass', true);
                                }
                                return value;
                            }
                            mCtrl.$parsers.push(myValidation);
                        }
                    };
                });


                // Проверку пароля выполнить с помощью сервиса

            app.service('validator', function () {
                this.emailValidator = function (email) {
                    if (email == 'badReq@mail.com') {
                        return "Неправильный логин!";
                    } else {
                        return "";
                    }
                }

                this.passValidator = function (password) {
                    if (password == 'badReq') {
                        return "Неправильный пароль!";
                    } else {
                        return "";
                    }
                }
            });


            app.controller('myCtrl', function ($scope, validator) {
                $scope.EmailValidation = function (email) {
                    $scope.emailErrorMessage = validator.emailValidator(email);
                };

                $scope.PassValidation = function (password) {
                    $scope.passErrorMessage = validator.passValidator(password);
                };
            });

        </script>
</body>

</html>